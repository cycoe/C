<span class="cp">#include</span> <span class="cpf">&lt;math.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="cp">#define PI 3.14159265359
</span><span class="cp"></span>
<span class="kt">float</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">;</span>

<span class="kt">float</span> <span class="nf">sdCircle</span><span class="p">(</span><span class="kt">float</span> <span class="n">px</span><span class="p">,</span> <span class="kt">float</span> <span class="n">py</span><span class="p">,</span> <span class="kt">float</span> <span class="n">r</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">float</span> <span class="n">dx</span> <span class="o">=</span> <span class="n">px</span> <span class="o">-</span> <span class="n">sx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">py</span> <span class="o">-</span> <span class="n">sy</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">sqrtf</span><span class="p">(</span><span class="n">dx</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span> <span class="o">-</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">float</span> <span class="nf">opUnion</span><span class="p">(</span><span class="kt">float</span> <span class="n">d1</span><span class="p">,</span> <span class="kt">float</span> <span class="n">d2</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">d1</span> <span class="o">&lt;</span> <span class="n">d2</span> <span class="o">?</span> <span class="nl">d1</span> <span class="p">:</span> <span class="n">d2</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#define T px + scale * r * cosf(theta), py + scale * r * sin(theta)
</span><span class="cp"></span>
<span class="kt">float</span> <span class="nf">f</span><span class="p">(</span><span class="kt">float</span> <span class="n">px</span><span class="p">,</span> <span class="kt">float</span> <span class="n">py</span><span class="p">,</span> <span class="kt">float</span> <span class="n">theta</span><span class="p">,</span> <span class="kt">float</span> <span class="n">scale</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">float</span> <span class="n">d</span> <span class="o">=</span> <span class="mf">0.0f</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">float</span> <span class="n">r</span> <span class="o">=</span> <span class="mf">0.0f</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mf">0.8f</span><span class="p">;</span> <span class="n">r</span> <span class="o">+=</span> <span class="mf">0.02f</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">opUnion</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">sdCircle</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="mf">0.05f</span> <span class="o">*</span> <span class="n">scale</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.95f</span> <span class="o">-</span> <span class="n">r</span><span class="p">)));</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">t</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">t</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">float</span> <span class="n">tt</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">+</span> <span class="n">t</span> <span class="o">*</span> <span class="mf">1.8f</span><span class="p">;</span>
            <span class="kt">float</span> <span class="n">ss</span> <span class="o">=</span> <span class="n">scale</span> <span class="o">*</span> <span class="mf">0.9f</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">float</span> <span class="n">r</span> <span class="o">=</span> <span class="mf">0.2f</span><span class="p">;</span> <span class="n">r</span> <span class="o">&lt;</span> <span class="mf">0.8f</span><span class="p">;</span> <span class="n">r</span> <span class="o">+=</span> <span class="mf">0.1f</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">opUnion</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">tt</span><span class="p">,</span> <span class="n">ss</span> <span class="o">*</span> <span class="mf">0.5f</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">));</span>
                <span class="n">ss</span> <span class="o">*=</span> <span class="mf">0.8f</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="k">return</span> <span class="n">d</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">argc</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">?</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">:</span> <span class="mi">3</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">sy</span> <span class="o">=</span> <span class="mf">0.8f</span><span class="p">;</span> <span class="n">sy</span> <span class="o">&gt;</span> <span class="mf">0.0f</span><span class="p">;</span> <span class="n">sy</span> <span class="o">-=</span> <span class="mf">0.02f</span><span class="p">,</span> <span class="n">putchar</span><span class="p">(</span><span class="sc">'\n'</span><span class="p">))</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">sx</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.35f</span><span class="p">;</span> <span class="n">sx</span> <span class="o">&lt;</span> <span class="mf">0.35f</span><span class="p">;</span> <span class="n">sx</span> <span class="o">+=</span> <span class="mf">0.01f</span><span class="p">)</span>
            <span class="n">putchar</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">PI</span> <span class="o">*</span> <span class="mf">0.5f</span><span class="p">,</span> <span class="mf">1.0f</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="sc">'*'</span> <span class="o">:</span> <span class="sc">' '</span><span class="p">);</span>
<span class="p">}</span>

